<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="appTitle">Apartment Management</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg" />
    <link rel="apple-touch-icon" href="assets/favicon.svg" />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/responsive.css" />
  </head>
  <body>
    <div class="logo-bar">
      <div class="logo-link">
        <img src="logo/logo.svg" alt="Logo" class="logo-image" />
        <div class="logo-text">
          <span class="logo-text-en" data-i18n="logoTextEn">Apartment for you</span>
          <span class="logo-text-sq" data-i18n="logoTextSq">Banesë për Ty</span>
        </div>
      </div>
      <div class="logo-bar-controls">
        <button
          type="button"
          id="languageToggleBtn"
          class="icon-button"
          title="Language"
          aria-label="Toggle Language"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="2" y1="12" x2="22" y2="12"></line>
            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
          </svg>
        </button>
        <button
          type="button"
          id="themeToggleBtn"
          class="icon-button"
          title="Theme"
          aria-label="Toggle Theme"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="theme-icon-light">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="theme-icon-dark" style="display: none;">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </button>
        <button
          type="button"
          id="menuToggleBtn"
          class="menu-toggle-btn"
          title="Menu"
          aria-label="Toggle Menu"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>
        <button
          type="button"
          id="resetAppBtn"
          class="icon-button"
          title="Reset App"
          aria-label="Reset Application"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
            <path d="M21 3v5h-5"></path>
            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
            <path d="M3 21v-5h5"></path>
          </svg>
        </button>
      </div>
    </div>

    <main>
      <section id="notificationArea" aria-live="polite"></section>
      <div id="confirmationModal" class="confirmation-modal" style="display: none;">
        <div class="confirmation-animation-container" id="confirmationAnimationContainer"></div>
      </div>
      
      <!-- Photo Viewer Modal -->
      <div id="photoViewerModal" class="photo-viewer-modal" style="display: none;">
        <div class="photo-viewer-content">
          <button class="photo-viewer-close" id="photoViewerClose">&times;</button>
          <button class="photo-viewer-nav photo-viewer-prev" id="photoViewerPrev">&#8249;</button>
          <button class="photo-viewer-nav photo-viewer-next" id="photoViewerNext">&#8250;</button>
          <div class="photo-viewer-main">
            <img id="photoViewerImage" src="" alt="Apartment Photo" />
          </div>
          <div class="photo-viewer-info">
            <span id="photoViewerCounter"></span>
          </div>
          <div class="photo-viewer-thumbnails" id="photoViewerThumbnails"></div>
        </div>
      </div>
      
      <!-- Photo Review Modal (for upload previews) -->
      <div id="photoReviewModal" class="photo-viewer-modal" style="display: none;">
        <div class="photo-viewer-content">
          <button class="photo-viewer-close" id="photoReviewClose">&times;</button>
          <div class="photo-viewer-main">
            <img id="photoReviewImage" src="" alt="Photo Review" />
          </div>
          <div class="photo-review-actions">
            <button type="button" class="button-danger" id="photoReviewDelete" data-i18n="delete">Delete</button>
            <button type="button" class="button-primary" id="photoReviewKeep" data-i18n="keep">Keep</button>
          </div>
        </div>
      </div>
      
      <!-- Delete Apartment Confirmation Modal -->
      <div id="deleteApartmentModal" class="delete-confirmation-modal" style="display: none;">
        <div class="delete-confirmation-content">
          <h3 data-i18n="confirmDeleteApartmentTitle">Confirm Deletion</h3>
          <p class="delete-confirmation-message" id="deleteApartmentMessage"></p>
          <div class="form-group">
            <label for="deleteApartmentNameInput" data-i18n="typeApartmentNameToConfirm">Type the apartment name to confirm deletion:</label>
            <input
              type="text"
              id="deleteApartmentNameInput"
              class="form-input"
              placeholder=""
              autocomplete="off"
            />
            <small class="form-hint" id="deleteApartmentHint"></small>
          </div>
          <div class="delete-confirmation-actions">
            <button type="button" class="button-secondary" id="deleteApartmentCancel" data-i18n="cancel">Cancel</button>
            <button type="button" class="button-danger" id="deleteApartmentConfirm" data-i18n="delete" disabled>Delete</button>
          </div>
        </div>
      </div>
      
      <!-- Mark Paid Payment Modal -->
      <div id="markPaidModal" class="mark-paid-modal" style="display: none;">
        <div class="mark-paid-modal-content">
          <h3 data-i18n="markPaid">Mark Paid</h3>
          <div class="mark-paid-form">
            <div class="form-group">
              <label data-i18n="amount">Amount</label>
              <input type="number" id="markPaidAmount" step="0.01" readonly>
            </div>
            <div class="form-group">
              <label data-i18n="paymentDate">Payment Date</label>
              <div class="date-input-group">
                <input type="number" id="markPaidDay" class="date-input date-day" placeholder="DD" min="1" max="31" required />
                <input type="number" id="markPaidMonth" class="date-input date-month" placeholder="MM" min="1" max="12" required />
                <input type="number" id="markPaidYear" class="date-input date-year" placeholder="YYYY" min="2020" max="2030" required />
              </div>
              <input type="hidden" id="markPaidDate" />
            </div>
            <div class="form-group">
              <label data-i18n="paymentMethod">Payment Method</label>
              <div class="payment-method-buttons">
                <button type="button" class="payment-method-btn" data-method="Cash">Cash</button>
                <button type="button" class="payment-method-btn" data-method="Bank transfer">Bank transfer</button>
                <button type="button" class="payment-method-btn" data-method="Online payment">Online payment</button>
                <button type="button" class="payment-method-btn" data-method="custom">Custom</button>
              </div>
              <input type="text" id="markPaidMethod" placeholder="Enter payment method" style="display: none; margin-top: 0.5rem;">
            </div>
            <div class="form-actions">
              <button type="button" class="button-secondary" id="markPaidCancel">Cancel</button>
              <button type="button" class="button-primary" id="markPaidSubmit">Enter</button>
            </div>
          </div>
        </div>
      </div>

      <section id="adminView" class="view">
        <div class="admin-nav-container">
          <nav class="admin-nav" id="adminNav">
          <button type="button" data-page="apartments" data-i18n="navApartments">
            Apartments
          </button>
          <button type="button" data-page="tenants" data-i18n="navTenants">Tenants</button>
          <button type="button" data-page="contracts" data-i18n="navContracts">Contracts</button>
          <button type="button" data-page="requests" data-i18n="navRequests">Requests</button>
          <div class="nav-group">
            <span class="nav-group-label" data-i18n="navExpensesGroup">Expenses</span>
            <div class="nav-group-buttons">
              <button type="button" data-page="expenses" data-expense-type="all" data-i18n="navExpensesAll">
                All
              </button>
              <button
                type="button"
                data-page="expenses"
                data-expense-type="rent"
                class="active"
                data-i18n="navExpensesRent"
              >
                Rent
              </button>
              <button
                type="button"
                data-page="expenses"
                data-expense-type="garbage"
                data-i18n="navExpensesGarbage"
              >
                Garbage
              </button>
              <button
                type="button"
                data-page="expenses"
                data-expense-type="maintenance"
                data-i18n="navExpensesMaintenance"
              >
                Maintenance
              </button>
              <button
                type="button"
                data-page="expenses"
                data-expense-type="electricity"
                data-i18n="navExpensesElectricity"
              >
                Electricity
              </button>
              <button
                type="button"
                data-page="expenses"
                data-expense-type="water"
                data-i18n="navExpensesWater"
              >
                Water
              </button>
              <button
                type="button"
                data-page="expenses"
                data-expense-type="heating"
                data-i18n="navExpensesHeating"
              >
                Heating
              </button>
            </div>
          </div>
          <button type="button" data-page="payments" data-i18n="navPayments">Payments</button>
        </nav>
        </div>

        <!-- Global Contract Filter -->
        <div class="global-tenant-filter">
          <label for="globalContractFilter" data-i18n="filterByContract">Filter by Contract:</label>
          <select id="globalContractFilter">
            <option value="" data-i18n="allContracts">All Contracts</option>
          </select>
          <button type="button" id="clearContractFilter" class="button-secondary button-small" data-i18n="clearFilter">Clear</button>
        </div>

        <section id="page-apartments" class="admin-page" data-page="apartments">
          <article class="card" id="apartmentsCard">
            <header>
              <h3 data-i18n="apartmentsTitle">Apartments</h3>
            </header>
            <form id="apartmentForm" class="form-grid">
              <input type="hidden" id="apartmentId" name="apartment_id" />
              <div class="field">
                <label for="apartmentName" data-i18n="apartmentName"
                  >Name</label
                >
                <input
                  type="text"
                  id="apartmentName"
                  name="name"
                  required
                  placeholder="Ex: Apartment 4B"
                />
              </div>
              <div class="field">
                <label for="apartmentAddress" data-i18n="apartmentAddress"
                  >Address</label
                >
                <input
                  type="text"
                  id="apartmentAddress"
                  name="address"
                  placeholder="Street, City"
                />
              </div>
              <div class="field">
                <label for="apartmentElectricityCode" data-i18n="apartmentElectricityCode"
                  >Electricity Code</label
                >
                <input
                  type="text"
                  id="apartmentElectricityCode"
                  name="electricity_code"
                  placeholder="Electricity meter code"
                />
              </div>
              <div class="field">
                <label for="apartmentHeatingCode" data-i18n="apartmentHeatingCode"
                  >Heating Code</label
                >
                <input
                  type="text"
                  id="apartmentHeatingCode"
                  name="heating_code"
                  placeholder="Heating account"
                />
              </div>
              <div class="field">
                <label for="apartmentWaterCode" data-i18n="apartmentWaterCode"
                  >Water Code</label
                >
                <input
                  type="text"
                  id="apartmentWaterCode"
                  name="water_code"
                  placeholder="Water meter code"
                />
              </div>
              <div class="field">
                <label for="apartmentWasteCode" data-i18n="apartmentWasteCode"
                  >Waste Code</label
                >
                <input
                  type="text"
                  id="apartmentWasteCode"
                  name="waste_code"
                  placeholder="Waste account"
                />
              </div>
              <div class="field">
                <label for="apartmentCondition" data-i18n="apartmentCondition">Condition</label>
                <select id="apartmentCondition" name="condition">
                  <option value="">-</option>
                  <option value="New" data-i18n="conditionNew">New</option>
                  <option value="Renovated" data-i18n="conditionRenovated">Renovated</option>
                  <option value="Good" data-i18n="conditionGood">Good</option>
                  <option value="Needs Renovation" data-i18n="conditionNeedsRenovation">Needs Renovation</option>
                </select>
              </div>
              <div class="field-group">
                <div class="field">
                  <label for="apartmentRooms" data-i18n="apartmentRooms">Number of Rooms</label>
                  <select id="apartmentRooms" name="rooms">
                    <option value="">-</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value=">10">>10</option>
                  </select>
                </div>
                <div class="field">
                  <label for="apartmentBalconies" data-i18n="apartmentBalconies">Number of Balconies</label>
                  <select id="apartmentBalconies" name="balconies">
                    <option value="">-</option>
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>
                <div class="field">
                  <label for="apartmentBathrooms" data-i18n="apartmentBathrooms">Number of Bathrooms</label>
                  <select id="apartmentBathrooms" name="bathrooms">
                    <option value="">-</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>
                <div class="field">
                  <label for="apartmentArea" data-i18n="apartmentArea">Area (m²)</label>
                  <input
                    type="number"
                    id="apartmentArea"
                    name="area"
                    min="15"
                    max="300"
                    step="0.01"
                    placeholder="e.g. 75.5"
                  />
                </div>
              </div>
              <div class="field-group">
                <div class="field">
                  <label for="apartmentMunicipality" data-i18n="apartmentMunicipality">Municipality</label>
                  <select id="apartmentMunicipality" name="municipality">
                    <option value="">-</option>
                    <option value="Prishtina" data-i18n="municipalityPrishtina">Prishtina</option>
                    <option value="Prizren" data-i18n="municipalityPrizren">Prizren</option>
                    <option value="Peja" data-i18n="municipalityPeja">Peja</option>
                    <option value="Mitrovica" data-i18n="municipalityMitrovica">Mitrovica</option>
                    <option value="Gjakova" data-i18n="municipalityGjakova">Gjakova</option>
                    <option value="Gjilan" data-i18n="municipalityGjilan">Gjilan</option>
                    <option value="Ferizaj" data-i18n="municipalityFerizaj">Ferizaj</option>
                    <option value="Podujeva" data-i18n="municipalityPodujeva">Podujeva</option>
                    <option value="Rahovec" data-i18n="municipalityRahovec">Rahovec</option>
                    <option value="Lipjan" data-i18n="municipalityLipjan">Lipjan</option>
                    <option value="Malisheva" data-i18n="municipalityMalisheva">Malisheva</option>
                    <option value="Suhareka" data-i18n="municipalitySuhareka">Suhareka</option>
                    <option value="Vushtrri" data-i18n="municipalityVushtrri">Vushtrri</option>
                    <option value="Skenderaj" data-i18n="municipalitySkenderaj">Skenderaj</option>
                    <option value="Drenas" data-i18n="municipalityDrenas">Drenas</option>
                    <option value="Istog" data-i18n="municipalityIstog">Istog</option>
                    <option value="Kamenica" data-i18n="municipalityKamenica">Kamenica</option>
                    <option value="Viti" data-i18n="municipalityViti">Viti</option>
                    <option value="Deçan" data-i18n="municipalityDecan">Deçan</option>
                    <option value="Junik" data-i18n="municipalityJunik">Junik</option>
                    <option value="Klina" data-i18n="municipalityKlina">Klina</option>
                    <option value="Leposaviq" data-i18n="municipalityLeposaviq">Leposaviq</option>
                    <option value="Zubin Potok" data-i18n="municipalityZubinPotok">Zubin Potok</option>
                    <option value="Zveçan" data-i18n="municipalityZvecan">Zveçan</option>
                    <option value="Shtime" data-i18n="municipalityShtime">Shtime</option>
                    <option value="Kaçanik" data-i18n="municipalityKacanik">Kaçanik</option>
                    <option value="Hani i Elezit" data-i18n="municipalityHaniElezit">Hani i Elezit</option>
                    <option value="Graçanica" data-i18n="municipalityGracanica">Graçanica</option>
                    <option value="Ranillug" data-i18n="municipalityRanillug">Ranillug</option>
                    <option value="Partesh" data-i18n="municipalityPartesh">Partesh</option>
                    <option value="Kllokot" data-i18n="municipalityKllokot">Kllokot</option>
                    <option value="Novobërdë" data-i18n="municipalityNovoberde">Novobërdë</option>
                    <option value="Other" data-i18n="municipalityOther">Other</option>
                  </select>
                </div>
                <div class="field">
                  <label for="apartmentMonthlyRent" data-i18n="apartmentMonthlyRent">Monthly Rent Price (EUR)</label>
                  <input
                    type="number"
                    id="apartmentMonthlyRent"
                    name="monthly_rent"
                    min="0"
                    step="0.01"
                    placeholder="e.g. 350"
                  />
                </div>
              </div>
              <div class="field">
                <label for="apartmentFeatures" data-i18n="apartmentFeatures">Features</label>
                <div class="features-select-container">
                  <div class="features-buttons" id="apartmentFeaturesButtons">
                    <button type="button" class="feature-button" data-feature="Balcony/Terrace" data-i18n-en="Balcony/Terrace" data-i18n-sq="Ballkon/Tarracë">Balcony/Terrace</button>
                    <button type="button" class="feature-button" data-feature="Wood Stove/Fireplace" data-i18n-en="Wood Stove/Fireplace" data-i18n-sq="Sobë me Dru/Oxhak">Wood Stove/Fireplace</button>
                    <button type="button" class="feature-button" data-feature="Elevator" data-i18n-en="Elevator" data-i18n-sq="Ashensor">Elevator</button>
                    <button type="button" class="feature-button" data-feature="First Floor" data-i18n-en="First Floor" data-i18n-sq="Kati i Parë">First Floor</button>
                    <button type="button" class="feature-button" data-feature="Parking Space/Garage" data-i18n-en="Parking Space/Garage" data-i18n-sq="Parkim/Garaj">Parking Space/Garage</button>
                    <button type="button" class="feature-button" data-feature="Attic Floor" data-i18n-en="Attic Floor" data-i18n-sq="Kati i Papafingo">Attic Floor</button>
                    <button type="button" class="feature-button" data-feature="New Building" data-i18n-en="New Building" data-i18n-sq="Ndërtesë e Re">New Building</button>
                    <button type="button" class="feature-button" data-feature="Renovated" data-i18n-en="Renovated" data-i18n-sq="E Renovuar">Renovated</button>
                    <button type="button" class="feature-button" data-feature="Furnished" data-i18n-en="Furnished" data-i18n-sq="E Mobiluar">Furnished</button>
                    <button type="button" class="feature-button" data-feature="Basement" data-i18n-en="Basement" data-i18n-sq="Bodrum">Basement</button>
                    <button type="button" class="feature-button" data-feature="Intercom" data-i18n-en="Intercom" data-i18n-sq="Interkom">Intercom</button>
                    <button type="button" class="feature-button" data-feature="Duplex" data-i18n-en="Duplex" data-i18n-sq="Dupleks">Duplex</button>
                  </div>
                  <select id="apartmentFeatures" name="features" multiple style="display: none;">
                    <option value="Balcony/Terrace" data-i18n-en="Balcony/Terrace" data-i18n-sq="Ballkon/Tarracë">Balcony/Terrace</option>
                    <option value="Wood Stove/Fireplace" data-i18n-en="Wood Stove/Fireplace" data-i18n-sq="Sobë me Dru/Oxhak">Wood Stove/Fireplace</option>
                    <option value="Elevator" data-i18n-en="Elevator" data-i18n-sq="Ashensor">Elevator</option>
                    <option value="First Floor" data-i18n-en="First Floor" data-i18n-sq="Kati i Parë">First Floor</option>
                    <option value="Parking Space/Garage" data-i18n-en="Parking Space/Garage" data-i18n-sq="Parkim/Garaj">Parking Space/Garage</option>
                    <option value="Attic Floor" data-i18n-en="Attic Floor" data-i18n-sq="Kati i Papafingo">Attic Floor</option>
                    <option value="New Building" data-i18n-en="New Building" data-i18n-sq="Ndërtesë e Re">New Building</option>
                    <option value="Renovated" data-i18n-en="Renovated" data-i18n-sq="E Renovuar">Renovated</option>
                    <option value="Furnished" data-i18n-en="Furnished" data-i18n-sq="E Mobiluar">Furnished</option>
                    <option value="Basement" data-i18n-en="Basement" data-i18n-sq="Bodrum">Basement</option>
                    <option value="Intercom" data-i18n-en="Intercom" data-i18n-sq="Interkom">Intercom</option>
                    <option value="Duplex" data-i18n-en="Duplex" data-i18n-sq="Dupleks">Duplex</option>
                  </select>
                </div>
              </div>
              <div class="field">
                <label for="apartmentDescription" data-i18n="apartmentDescription">Description</label>
                <textarea
                  id="apartmentDescription"
                  name="description"
                  rows="4"
                  placeholder="Add a detailed description of the apartment, features, nearby amenities, and any rules or requirements"
                ></textarea>
              </div>
              <div class="field">
                <label for="apartmentPhotos" data-i18n="apartmentPhotos"
                  >Photos</label
                >
                <div id="photoUploadArea" class="photo-upload-area">
                  <input
                    type="file"
                    id="apartmentPhotos"
                    name="photos"
                    accept="image/*"
                    multiple
                    style="display: none;"
                  />
                  <div class="photo-upload-dropzone" id="photoDropzone">
                    <p data-i18n="photoUploadDragDrop">Drag and drop photos here, or click to select</p>
                    <p class="photo-upload-hint" data-i18n="photoUploadHint">You can select multiple photos (max 10)</p>
                  </div>
                  <div id="photoPreviewContainer" class="photo-preview-container"></div>
                </div>
              </div>
              <div class="form-actions">
                <button type="submit" id="apartmentSubmitBtn" data-i18n="addApartment">
                  Add Apartment
                </button>
                <button type="button" id="apartmentCancelBtn" class="button-secondary hidden" data-i18n="cancelEdit">
                  Cancel
                </button>
              </div>
            </form>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th data-i18n="apartmentPhoto">Photo</th>
                    <th data-i18n="apartmentName">Name</th>
                    <th data-i18n="apartmentAddress">Address</th>
                    <th data-i18n="apartmentElectricityCode">Electricity Code</th>
                    <th data-i18n="apartmentHeatingCode">Heating Code</th>
                    <th data-i18n="apartmentWaterCode">Water Code</th>
                    <th data-i18n="apartmentWasteCode">Waste Code</th>
                    <th data-i18n="apartmentStatus">Status</th>
                    <th data-i18n="actions">Actions</th>
                    <th>ID</th>
                  </tr>
                </thead>
                <tbody id="apartmentsTableBody"></tbody>
              </table>
            </div>
          </article>
        </section>

        <section id="page-tenants" class="admin-page" data-page="tenants">
          <article class="card" id="tenantsCard">
            <header>
              <h3 data-i18n="tenantsTitle">Tenants</h3>
            </header>
            <form id="tenantForm" class="form-grid">
              <div class="field">
                <label for="tenantFullName" data-i18n="tenantFullName"
                  >Full Name</label
                >
                <input
                  type="text"
                  id="tenantFullName"
                  name="full_name"
                  required
                  placeholder="John Doe"
                />
              </div>
              <div class="field">
                <label for="tenantEmail" data-i18n="tenantEmail">Email</label>
                <input
                  type="email"
                  id="tenantEmail"
                  name="email"
                  placeholder="example@email.com"
                />
              </div>
              <div class="field">
                <label for="tenantPhone" data-i18n="tenantPhone">Phone</label>
                <input
                  type="tel"
                  id="tenantPhone"
                  name="phone"
                  placeholder="+383-xx-xxx-xxx"
                />
              </div>
              <button type="submit" data-i18n="addTenant">Add Tenant</button>
            </form>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th data-i18n="tenantFullName">Full Name</th>
                    <th data-i18n="tenantEmail">Email</th>
                    <th data-i18n="tenantPhone">Phone</th>
                    <th>ID</th>
                  </tr>
                </thead>
                <tbody id="tenantsTableBody"></tbody>
              </table>
            </div>
          </article>
        </section>

        <section id="page-contracts" class="admin-page" data-page="contracts">
          <article class="card" id="contractsCard">
            <header>
              <h3 data-i18n="contractsTitle">Contracts</h3>
            </header>
            <form id="contractForm" class="form-grid">
              <div class="field">
                <label for="contractApartment" data-i18n="selectApartment"
                  >Apartment</label
                >
                <select id="contractApartment" name="apartment_id" required></select>
              </div>
              <div class="field">
                <label for="contractTenant" data-i18n="selectTenant"
                  >Tenant</label
                >
                <select id="contractTenant" name="tenant_id" required></select>
              </div>
              <div class="field">
                <label for="contractStartDate" data-i18n="startDate"
                  >Start Date</label
                >
                <input type="date" id="contractStartDate" name="start_date" required />
              </div>
              <div class="field">
                <label for="contractEndDate" data-i18n="endDate">End Date</label>
                <input type="date" id="contractEndDate" name="end_date" min="2020-01-01" max="2030-12-31" />
              </div>
              <div class="field">
                <label for="contractRent" data-i18n="monthlyRent"
                  >Monthly Rent</label
                >
                <input
                  type="number"
                  id="contractRent"
                  name="monthly_rent"
                  min="0"
                  step="0.01"
                  required
                />
              </div>
              <div class="field">
                <label for="contractGarbage" data-i18n="monthlyGarbage"
                  >Monthly Garbage</label
                >
                <input
                  type="number"
                  id="contractGarbage"
                  name="monthly_garbage"
                  min="0"
                  step="0.01"
                  value="0"
                />
              </div>
              <div class="field">
                <label for="contractMaintenance" data-i18n="monthlyMaintenance"
                  >Monthly Maintenance</label
                >
                <input
                  type="number"
                  id="contractMaintenance"
                  name="monthly_maintenance"
                  min="0"
                  step="0.01"
                  value="0"
                />
              </div>
              <div class="field">
                <label for="contractDeposit" data-i18n="contractDeposit"
                  >Deposit</label
                >
                <input
                  type="number"
                  id="contractDeposit"
                  name="deposit_amount"
                  min="0"
                  step="0.01"
                />
              </div>
              <div class="field checkbox">
                <label for="contractActive" data-i18n="contractActive"
                  >Active</label
                >
                <input type="checkbox" id="contractActive" name="is_active" checked />
              </div>
              <button type="submit" data-i18n="addContract">Add Contract</button>
            </form>

            <!-- Active contracts table -->
            <div class="table-wrapper">
              <h4 data-i18n="contractsActiveTitle">Active contracts</h4>
              <table>
                <thead>
                  <tr>
                    <th data-i18n="selectApartment">Apartment</th>
                    <th data-i18n="selectTenant">Tenant</th>
                    <th data-i18n="startDate">Start</th>
                    <th data-i18n="endDate">End</th>
                    <th data-i18n="monthlyRent">Rent</th>
                    <th data-i18n="monthlyGarbage">Garbage</th>
                    <th data-i18n="monthlyMaintenance">Maintenance</th>
                    <th data-i18n="contractDeposit">Deposit</th>
                    <th data-i18n="contractActive">Active</th>
                    <th data-i18n="actions">Actions</th>
                  </tr>
                </thead>
                <tbody id="contractsActiveTableBody"></tbody>
              </table>
            </div>

            <!-- Inactive contracts table -->
            <div class="table-wrapper">
              <h4 data-i18n="contractsInactiveTitle">Inactive contracts</h4>
              <table>
                <thead>
                  <tr>
                    <th data-i18n="selectApartment">Apartment</th>
                    <th data-i18n="selectTenant">Tenant</th>
                    <th data-i18n="startDate">Start</th>
                    <th data-i18n="endDate">End</th>
                    <th data-i18n="monthlyRent">Rent</th>
                    <th data-i18n="monthlyGarbage">Garbage</th>
                    <th data-i18n="monthlyMaintenance">Maintenance</th>
                    <th data-i18n="contractDeposit">Deposit</th>
                    <th data-i18n="contractActive">Active</th>
                    <th data-i18n="actions">Actions</th>
                  </tr>
                </thead>
                <tbody id="contractsInactiveTableBody"></tbody>
              </table>
            </div>
          </article>
        </section>

        <section id="page-expenses" class="admin-page" data-page="expenses">
          <article class="card" id="debtsPaymentsCard">
            <header>
              <div>
                <h3 id="expensesHeading" data-i18n="expensesHeadingAll">All Expenses</h3>
                <p id="expensesSubheading" data-i18n="debtsPaymentsSubtitle">
                  Track rent, utilities, damages and more.
                </p>
              </div>
            </header>
            <div class="form-toggle" id="expenseFormToggle">
              <button
                type="button"
                class="active"
                data-expense-form-mode="expense"
                data-i18n="expenseFormToggleExpense"
              >
                Create Expense
              </button>
              <button
                type="button"
                data-expense-form-mode="payment"
                data-i18n="expenseFormTogglePayment"
              >
                Record Payment
              </button>
            </div>
            <div class="summary-controls">
              <button id="toggleExpenseSummary" type="button" data-i18n="toggleExpenseSummary">
                Tenant Summary
              </button>
            </div>
            <div class="summary-panel hidden" id="expenseSummaryPanel">
              <table>
                <thead>
                  <tr>
                    <th data-i18n="summaryTenant">Tenant</th>
                    <th data-i18n="summaryExpensesCount">Open Expenses</th>
                    <th data-i18n="summaryExpensesAmount">Open Amount</th>
                    <th data-i18n="summaryPaymentsCount">Payments</th>
                    <th data-i18n="summaryPaymentsAmount">Payments Amount</th>
                  </tr>
                </thead>
                <tbody id="expenseSummaryBody"></tbody>
              </table>
            </div>
            <div class="flex-columns">
              <form id="debtForm" class="form-grid" data-expense-mode="expense">
                <h4 data-i18n="createDebt">Create Expense</h4>
                <div class="field">
                  <label for="debtContract" data-i18n="selectContract"
                    >Contract</label
                  >
                  <select id="debtContract" name="contract_id" required></select>
                </div>
                <div class="field">
                  <label for="debtTenant" data-i18n="selectTenant">Tenant</label>
                  <select id="debtTenant" name="tenant_id" required></select>
                </div>
                <div class="field">
                  <label for="debtType" data-i18n="debtType">Type</label>
                  <select id="debtType" name="type" required>
                    <option value="rent" data-i18n="debtRent">Rent</option>
                    <option value="maintenance" data-i18n="debtMaintenance">
                      Maintenance
                    </option>
                    <option value="garbage" data-i18n="debtGarbage">Garbage</option>
                    <option value="thermos" data-i18n="debtThermos">Thermos</option>
                    <option value="electricity" data-i18n="debtElectricity">
                      Electricity
                    </option>
                    <option value="water" data-i18n="debtWater">Water</option>
                    <option value="damage" data-i18n="debtDamage">Damage</option>
                    <option value="other" data-i18n="debtOther">Other</option>
                  </select>
                </div>
                <div class="field">
                  <label for="debtAmount" data-i18n="amount">Amount</label>
                  <input
                    type="number"
                    id="debtAmount"
                    name="amount"
                    min="0"
                    step="0.01"
                    required
                  />
                </div>
                <div class="field checkbox" id="debtElectricityCutWrapper">
                  <label for="debtElectricityCut" data-i18n="electricityCutLabel"
                    >Electricity cut / disconnection</label
                  >
                  <input type="checkbox" id="debtElectricityCut" />
                </div>
                <div class="field">
                  <label data-i18n="dueDate">Due Date</label>
                  <div class="date-input-group">
                    <input type="number" id="debtDueDay" class="date-input date-day" placeholder="DD" min="1" max="31" required />
                    <input type="number" id="debtDueMonth" class="date-input date-month" placeholder="MM" min="1" max="12" required />
                    <input type="number" id="debtDueYear" class="date-input date-year" placeholder="YYYY" min="2020" max="2030" required />
                  </div>
                  <input type="hidden" id="debtDueDate" name="due_date" />
                </div>
                <div class="field">
                  <label for="debtNotes" data-i18n="notes">Notes</label>
                  <textarea id="debtNotes" name="notes" rows="2"></textarea>
                </div>
                <div class="form-actions">
                  <button type="submit" id="debtFormSubmit" data-i18n="createDebtButton">
                    Create Debt
                  </button>
                  <button
                    type="button"
                    id="debtFormCancelEdit"
                    class="button-muted hidden"
                    data-i18n="cancelEdit"
                  >
                    Cancel
                  </button>
                </div>
              </form>

              <form id="paymentForm" class="form-grid" data-expense-mode="payment">
                <h4 data-i18n="recordPayment">Record Payment</h4>
                <div class="field">
                  <label for="paymentDebt" data-i18n="selectDebt">Debt</label>
                  <select id="paymentDebt" name="debt_id" required></select>
                </div>
                <p id="paymentDebtSummary" class="form-help" aria-live="polite"></p>
                <div class="field">
                  <label for="paymentAmount" data-i18n="amount">Amount</label>
                  <input
                    type="number"
                    id="paymentAmount"
                    name="amount"
                    min="0"
                    step="0.01"
                    required
                  />
                </div>
                <div class="field">
                  <label data-i18n="paymentDate">Payment Date</label>
                  <div class="date-input-group">
                    <input type="number" id="paymentDay" class="date-input date-day" placeholder="DD" min="1" max="31" required />
                    <input type="number" id="paymentMonth" class="date-input date-month" placeholder="MM" min="1" max="12" required />
                    <input type="number" id="paymentYear" class="date-input date-year" placeholder="YYYY" min="2020" max="2030" required />
                  </div>
                  <input type="hidden" id="paymentDate" name="payment_date" />
                </div>
                <div class="field">
                  <label for="paymentMethod" data-i18n="paymentMethod"
                    >Method</label
                  >
                  <div class="payment-method-buttons">
                    <button type="button" class="payment-method-btn payment-form-method-btn" data-method="Cash">Cash</button>
                    <button type="button" class="payment-method-btn payment-form-method-btn" data-method="Bank transfer">Bank transfer</button>
                    <button type="button" class="payment-method-btn payment-form-method-btn" data-method="Online payment">Online payment</button>
                    <button type="button" class="payment-method-btn payment-form-method-btn" data-method="custom">Custom</button>
                  </div>
                  <input
                    type="text"
                    id="paymentMethod"
                    name="method"
                    placeholder="Enter payment method"
                    style="display: none; margin-top: 0.5rem;"
                  />
                </div>
                <div class="form-actions">
                  <button type="submit" id="paymentFormSubmit" data-i18n="recordPaymentButton">
                    Record Payment
                  </button>
                  <button
                    type="button"
                    id="paymentFormCancelEdit"
                    class="button-muted hidden"
                    data-i18n="cancelEdit"
                  >
                    Cancel
                  </button>
                </div>
              </form>
            </div>

            <div class="toolbar" data-expense-mode="expense">
              <div>
                <label for="debtsFilterStatus" data-i18n="filterStatus"
                  >Status</label
                >
                <select id="debtsFilterStatus">
                  <option value="all" data-i18n="statusAll">All</option>
                  <option value="open_overdue" data-i18n="statusOpenOverdue">
                    Open &amp; Overdue
                  </option>
                  <option value="paid" data-i18n="statusPaid">Paid</option>
                </select>
              </div>
              <div>
                <label for="debtsFilterType" data-i18n="filterType">Type</label>
                <select id="debtsFilterType">
                  <option value="all" data-i18n="typeAll">All</option>
                  <option value="rent" data-i18n="debtRent">Rent</option>
                  <option value="maintenance" data-i18n="debtMaintenance">
                    Maintenance
                  </option>
                  <option value="garbage" data-i18n="debtGarbage">Garbage</option>
                  <option value="thermos" data-i18n="debtThermos">Thermos</option>
                  <option value="electricity" data-i18n="debtElectricity">
                    Electricity
                  </option>
                  <option value="water" data-i18n="debtWater">Water</option>
                  <option value="damage" data-i18n="debtDamage">Damage</option>
                  <option value="other" data-i18n="debtOther">Other</option>
                </select>
              </div>
              <div class="toolbar-actions">
                <button id="exportDebtsPdf" data-i18n="exportPdf">
                  Export Debts to PDF
                </button>
              </div>
            </div>

            <!-- Utility Summary Section (for electricity, water, heating) -->
            <div id="utilitySummarySection" class="utility-summary-section card" style="display: none;">
              <div class="utility-summary-header">
                <h4 data-i18n="utilitySummaryTitle">Utility Summary</h4>
                  </div>
              <div class="utility-summary-totals">
                <div class="utility-summary-item">
                  <span class="utility-summary-label" data-i18n="totalExpenses">Total Expenses:</span>
                  <span class="utility-summary-value" id="utilityTotalExpenses">€0.00</span>
                  </div>
                <div class="utility-summary-item">
                  <span class="utility-summary-label" data-i18n="totalPayments">Total Payments:</span>
                  <span class="utility-summary-value" id="utilityTotalPayments">€0.00</span>
                  </div>
                <div class="utility-summary-item utility-summary-difference">
                  <span class="utility-summary-label" data-i18n="difference">Difference:</span>
                  <span class="utility-summary-value" id="utilityDifference">€0.00</span>
                </div>
              </div>
              <div class="utility-tables-container">
                <div class="utility-table-wrapper">
                  <h5 data-i18n="expensesList">Expenses</h5>
                  <table>
                    <thead>
                      <tr>
                        <th>#</th>
                        <th data-i18n="selectTenant">Tenant</th>
                        <th data-i18n="debtType">Type</th>
                        <th data-i18n="amount">Amount</th>
                        <th data-i18n="dueDate">Due Date</th>
                        <th data-i18n="paymentReference">Reference</th>
                        <th data-i18n="actions">Actions</th>
                      </tr>
                    </thead>
                    <tbody id="utilityExpensesTableBody"></tbody>
                  </table>
                </div>
                <div class="utility-table-wrapper">
                  <h5 data-i18n="paymentsList">Payments</h5>
                  <table>
                    <thead>
                      <tr>
                        <th>#</th>
                        <th data-i18n="selectTenant">Tenant</th>
                        <th data-i18n="debtType">Type</th>
                        <th data-i18n="amount">Amount</th>
                        <th data-i18n="paymentDate">Date</th>
                        <th data-i18n="actions">Actions</th>
                      </tr>
                    </thead>
                    <tbody id="utilityPaymentsTableBody"></tbody>
                  </table>
                </div>
              </div>
            </div>

            <div class="table-wrapper" data-expense-mode="expense">
              <table>
                <thead>
                  <tr>
                    <th data-i18n="selectTenant">Tenant</th>
                    <th data-i18n="debtType">Type</th>
                    <th data-i18n="amount">Amount</th>
                    <th data-i18n="dueDate">Due</th>
                    <th data-i18n="status">Status</th>
                    <th data-i18n="paymentReference">Reference</th>
                    <th data-i18n="notes">Notes</th>
                    <th data-i18n="actions">Actions</th>
                  </tr>
                </thead>
                <tbody id="debtsTableBody"></tbody>
              </table>
            </div>
            <div class="table-wrapper hidden" data-expense-mode="payment">
              <table>
                <thead>
                  <tr>
                    <th data-i18n="selectTenant">Tenant</th>
                    <th data-i18n="debtType">Debt Type</th>
                    <th data-i18n="amount">Amount</th>
                    <th data-i18n="dueDate">Due Date</th>
                    <th data-i18n="paymentDate">Payment Date</th>
                    <th data-i18n="paymentMethod">Method</th>
                    <th data-i18n="paymentReference">Reference</th>
                    <th data-i18n="actions">Actions</th>
                  </tr>
                </thead>
                <tbody id="expensesPaymentsTableBody"></tbody>
              </table>
            </div>
          </article>
        </section>

        <section id="page-payments" class="admin-page" data-page="payments">
          <article class="card" id="paymentsCard">
            <header>
              <h3 data-i18n="paymentsHistory">Payments History</h3>
            </header>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th data-i18n="selectTenant">Tenant</th>
                    <th data-i18n="debtType">Debt Type</th>
                    <th data-i18n="amount">Amount</th>
                    <th data-i18n="dueDate">Due Date</th>
                    <th data-i18n="paymentDate">Payment Date</th>
                    <th data-i18n="paymentMethod">Method</th>
                    <th data-i18n="paymentReference">Reference</th>
                    <th data-i18n="actions">Actions</th>
                  </tr>
                </thead>
                <tbody id="paymentsTableBody"></tbody>
              </table>
            </div>
            <div class="table-wrapper">
              <h4 data-i18n="openExpensesHeading">Open &amp; Overdue Expenses</h4>
              <table>
                <thead>
                  <tr>
                    <th data-i18n="selectTenant">Tenant</th>
                    <th data-i18n="debtType">Type</th>
                    <th data-i18n="amount">Amount</th>
                    <th data-i18n="dueDate">Due</th>
                    <th data-i18n="status">Status</th>
                  </tr>
                </thead>
                <tbody id="openExpensesTableBody"></tbody>
              </table>
            </div>
          </article>
        </section>

        <section id="page-requests" class="admin-page" data-page="requests">
          <article class="card" id="requestsCard">
            <header>
              <h3 data-i18n="requestsTitle">Apartment Requests</h3>
            </header>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th data-i18n="requestApartment">Apartment</th>
                    <th data-i18n="requestTenant">Tenant</th>
                    <th data-i18n="requestType">Request Type</th>
                    <th data-i18n="requestMessage">Message</th>
                    <th data-i18n="requestDate">Date</th>
                    <th data-i18n="requestStatus">Status</th>
                    <th data-i18n="actions">Actions</th>
                  </tr>
                </thead>
                <tbody id="requestsTableBody"></tbody>
              </table>
            </div>
          </article>
        </section>
      </section>

      <section id="tenantView" class="view">
        <div class="card">
          <form id="tenantSelector" class="form-grid small">
            <div class="field">
              <label for="tenantSelect" data-i18n="selectTenant"
                >Select Tenant</label
              >
              <select id="tenantSelect"></select>
            </div>
            <button type="submit" data-i18n="loadTenant">Load Tenant</button>
          </form>
        </div>

        <div id="tenantSummary" class="grid">
          <article class="card">
            <h3 data-i18n="tenantInfo">Tenant Info</h3>
            <dl id="tenantInfoList"></dl>
          </article>
          <article class="card">
            <h3 data-i18n="contractInfo">Contract Info</h3>
            <dl id="tenantContractList"></dl>
          </article>
          <article class="card">
            <h3 data-i18n="financialSummary">Financial Summary</h3>
            <dl id="tenantFinancialList"></dl>
          </article>
        </div>

        <article class="card">
          <header>
            <h3 data-i18n="tenantDebts">Unpaid Expenses</h3>
            <div class="pdf-buttons">
              <span data-i18n="pdfOptionsHeading">Export Tenant PDF</span>
              <div class="pdf-format-selector">
                <label>
                  <input type="radio" name="pdfFormat" value="normal" checked>
                  <span data-i18n="pdfFormatNormal">Normal</span>
                </label>
                <label>
                  <input type="radio" name="pdfFormat" value="detailed">
                  <span data-i18n="pdfFormatDetailed">Detailed</span>
                </label>
              </div>
              <button type="button" id="exportTenantPdf" data-i18n="pdfOptionEnglish">
                Download in English
              </button>
              <button type="button" id="exportTenantPdfSq" data-i18n="pdfOptionAlbanian">
                Download in Albanian
              </button>
            </div>
          </header>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th data-i18n="debtType">Type</th>
                  <th data-i18n="amount">Amount</th>
                  <th data-i18n="dueDate">Due Date</th>
                  <th data-i18n="status">Status</th>
                  <th data-i18n="reference">Reference</th>
                </tr>
              </thead>
              <tbody id="tenantDebtsTableBody"></tbody>
            </table>
          </div>
        </article>

        <article class="card">
          <h3 data-i18n="tenantPayments">Payments</h3>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th data-i18n="amount">Amount</th>
                  <th data-i18n="debtType">Type</th>
                  <th data-i18n="paymentDate">Date</th>
                  <th data-i18n="paymentMethod">Method</th>
                  <th data-i18n="paymentReference">Reference</th>
                </tr>
              </thead>
              <tbody id="tenantPaymentsTableBody"></tbody>
            </table>
          </div>
        </article>
      </section>
    </main>

    <footer class="app-footer">
      <small data-i18n="footerNote">
        Powered by Florend Ramusa. Built for property managers and tenants.
      </small>
    </footer>

    <!-- Top Center Navigation Container -->
    <div class="top-nav-container">
      <button class="top-nav-btn" id="topNavStatistics" onclick="window.location.href='statistics.html'">
        <span data-i18n="floatingNavStatistics">Statistics</span>
      </button>
      <div class="top-nav-divider"></div>
      <button class="top-nav-btn" id="topNavAdmin" onclick="switchToAdminView()">
        <span data-i18n="floatingNavAdmin">Administrator</span>
      </button>
      <button class="top-nav-btn" id="topNavTenant" onclick="switchToTenantView()">
        <span data-i18n="floatingNavTenant">Tenant View</span>
      </button>
      <div class="top-nav-divider"></div>
      <button class="top-nav-btn" id="topNavProfile" onclick="window.location.href='profile.html'">
        <span data-i18n="floatingNavProfile">Profile</span>
      </button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" crossorigin="anonymous"></script>
    <!-- Load configuration first -->
    <script src="js/config.js"></script>
    <!-- Load shared translations before any app logic that uses them -->
    <script src="js/languages.js"></script>
    <script src="js/pdf-export.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>

